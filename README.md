<h1 align="center">üå±Project: Website b√°n th·ª±c ph·∫©m Organic</h1>

## üë§ Th√¥ng Tin C√° Nh√¢n  
- **H·ªç t√™n**: Phan Th·ªã Gia H√¢n
- **M√£ sinh vi√™n**: 23010840
- **L·ªõp**: CNTT_8
- **M√¥n h·ªçc**: X√¢y d·ª±ng web n√¢ng cao (TH3)

## üìà M·ª•c ƒë√≠ch d·ª± √°n
- X√¢y d·ª±ng website b√°n th·ª±c ph·∫©m Organic gi√∫p kh√°ch h√†ng d·ªÖ d√†ng xem, ƒë·∫∑t h√†ng, thanh to√°n v√† theo d√µi qu√° tr√¨nh giao h√†ng.
- H·ªó tr·ª£ ch·ªß shop qu·∫£n l√Ω s·∫£n ph·∫©m, ƒë∆°n h√†ng, kh√°ch h√†ng, danh m·ª•c v√† th√¥ng b√°o.
- Cung c·∫•p th√¥ng tin h·ªØu √≠ch v·ªÅ th·ª±c ph·∫©m s·∫°ch, gi√∫p kh√°ch h√†ng l·ª±a ch·ªçn s·∫£n ph·∫©m an to√†n cho s·ª©c kh·ªèe.

## üõ†Ô∏è C√¥ng ngh·ªá s·ª≠ d·ª•ng

| C√¥ng ngh·ªá | M√¥ t·∫£ |
|----------|-------|
| **Laravel (PHP)** | Backend framework ch√≠nh |
| **Laravel Breeze** | H·ªá th·ªëng x√°c th·ª±c, session |
| **Blade + Tailwind CSS** | Giao di·ªán ng∆∞·ªùi d√πng |
| **MySQL (Aiven)** | C∆° s·ªü d·ªØ li·ªáu |
| **Eloquent ORM** | Truy v·∫•n v√† x·ª≠ l√Ω d·ªØ li·ªáu |
| **Middleware** | B·∫£o m·∫≠t CSRF, ki·ªÉm so√°t truy c·∫≠p |

## ‚öôÔ∏è S∆° ƒë·ªì ch·ª©c nƒÉng

S∆° ƒë·ªì t·ªïng qu√°t

[![S∆° ƒë·ªì kh·ªëi](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/so-do-khoi.png)](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/so-do-khoi.png)


Quy tr√¨nh ƒë·∫∑t h√†ng

![image](https://github.com/user-attachments/assets/so-do-quy-trinh-dat-hang.png)

Qu·∫£n l√Ω s·∫£n ph·∫©m

![image](https://github.com/user-attachments/assets/so-do-quan-ly-san-pham.png)

Qu·∫£n l√Ω ƒë∆°n h√†ng & th√¥ng b√°o
![image](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/dh&tb.png)



## üìä S∆° ƒë·ªì tu·∫ßn t·ª±

ƒêƒÉng k√Ω t√†i kho·∫£n

![S∆° ƒë·ªì h·ªá th·ªëng](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/he-thong.png)




ƒê·∫∑t h√†ng & nh·∫≠n th√¥ng b√°o
             +---------------------+
             |  ƒê·∫∑t h√†ng & Nh·∫≠n th√¥ng b√°o |
             +-----------+---------+
                         |
         +---------------+--------------+
         |               |              |
         v               v              v
+----------------+  +----------------+  +-------------------+
| Ch·ªçn s·∫£n ph·∫©m  |  | Thanh to√°n     |  | Nh·∫≠n th√¥ng b√°o    |
+----------------+  +----------------+  +-------------------+
         |                                  |
         v                                  v
+--------------------+           +--------------------------+
| X√°c nh·∫≠n ƒë∆°n h√†ng  |           | Th√¥ng b√°o tr·∫°ng th√°i ƒë∆°n |
+--------------------+           +--------------------------+



![image](https://github.com/user-attachments/assets/so-do-dat-hang-thong-bao.png)

## S∆° ƒë·ªì kh·ªëi 

![image](https://github.com/user-attachments/assets/so-do-khoi-organic.png)

---

<h1>M·ªôt s·ªë code minh h·ªça</h1>

## Model

#### User Model 
```php
class User extends Authenticatable
{
    /** @use HasFactory<\Database\Factories\UserFactory> */
    use HasFactory, Notifiable;

    /**
     * The attributes that are mass assignable.
     *
     * @var list<string>
     */
    protected $fillable = [
        'name',
        'email',
        'password',
    ];

    /**
     * The attributes that should be hidden for serialization.
     *
     * @var list<string>
     */
    protected $hidden = [
        'password',
        'remember_token',
    ];

    /**
     * Get the attributes that should be cast.
     *
     * @return array<string, string>
     */
    protected function casts(): array
    {
        return [
            'email_verified_at' => 'datetime',
            'password' => 'hashed',
        ];
    }
}
 
```

#### Order Model

```php
class Order extends Model
{
    protected $fillable = [
        'user_id', 'name', 'email', 'phone', 'address',
        'order_notes', 'subtotal', 'total', 'payment_method', 'status'
    ];

    public function user()
    {
        return $this->belongsTo(User::class);
    }

    public function orderDetails()
    {
        return $this->hasMany(OrderDetail::class);
    }
    
       
}
```


### OrderDetail Model
```php
class OrderDetail extends Model
{
    protected $fillable = ['order_id', 'product_id', 'quantity', 'price', 'total'];

    public function order()
    {
        return $this->belongsTo(Order::class);
    }

    public function product()
    {
        return $this->belongsTo(Product::class);
    }
}
```

#### Product Model

```php
class Product extends Model
{
    protected $fillable = [
        'name', 'slug', 'description', 'price', 'discount_price', 'stock', 'image', 'category_id'
    ];

    public function category()
    {
        return $this->belongsTo(Category::class);
    }

    public function cartItems()
    {
        return $this->hasMany(CartItem::class);
    }

    public function orderItems()
    {
        return $this->hasMany(OrderItem::class);
    }

    public function reviews()
    {
        return $this->hasMany(Review::class);
    }
}
```
#### Category Model
```php
class Category extends Model
{
    protected $fillable = ['name', 'slug','image'];

    public function products()
    {
        return $this->hasMany(Product::class);
    }
}
```
### Contact Model

```php
class Contact extends Model
{
    protected $fillable = [
        'name',
        'email',
        'phone',
        'message',
        'is_read',
        'user_id', 
    ];

    /**
     * L·∫•y c√°c ph·∫£n h·ªìi c·ªßa admin.
     */
    public function replies(): HasMany
    {
        return $this->hasMany(ContactReply::class);
    }

    /**
     * L·∫•y th√¥ng tin user g·ª≠i tin nh·∫Øn.
     */
    public function user(): BelongsTo
    {
        return $this->belongsTo(User::class);
    }
}
```
### ContactReply Model
 ```php
 class ContactReply extends Model
{
    use HasFactory;

    protected $fillable = [
        'contact_id',
        'replied_by_user_id',
        'reply',
    ];
    public function contact()
    {
        return $this->belongsTo(Contact::class);
    }
    public function repliedBy()
    {
        return $this->belongsTo(User::class, 'replied_by_user_id');
    }
}
 ```

 ### Cart Model
 ```php
 class Cart extends Model
{
    protected $fillable = ['user_id', 'subtotal', 'total'];

    public function user()
    {
        return $this->belongsTo(User::class);
    }

    public function cartItems()
    {
        return $this->hasMany(CartItem::class);
    }
}
 ```

### CartItem Model
```php 
class CartItem extends Model
{
    protected $fillable = ['cart_id', 'product_id', 'quantity', 'price', 'total'];

    public function cart()
    {
        return $this->belongsTo(Cart::class);
    }

    public function product()
    {
        return $this->belongsTo(Product::class);
    }
}

```

### Notification Model
```php
class NotificationController extends Controller
{
    // Trang admin: hi·ªÉn th·ªã t·∫•t c·∫£ li√™n h·ªá + ph·∫£n h·ªìi
    public function index()
    {
        // ƒê√°nh d·∫•u to√†n b·ªô li√™n h·ªá l√† ƒë√£ ƒë·ªçc (ch·ªâ n√™n d√πng cho admin)
        Contact::where('is_read', false)->update(['is_read' => true]);

        // L·∫•y li√™n h·ªá m·ªõi nh·∫•t v√† ph·∫£n h·ªìi t∆∞∆°ng ·ª©ng
        $contacts = Contact::with('replies')->latest()->get();

        return view('admin.notification', compact('contacts'));
    }

    // Admin g·ª≠i ph·∫£n h·ªìi
    public function storeReply(Request $request)
    {
        $request->validate([
            'contact_id' => 'required|exists:contacts,id',
            'reply' => 'required|string',
        ]);

        ContactReply::create([
            'contact_id' => $request->contact_id,
            'replied_by_user_id' => Auth::id(),
            'reply' => $request->reply,
        ]);

        return redirect()->back()->with('success', 'ƒê√£ g·ª≠i ph·∫£n h·ªìi!');
    }

    // L·∫•y s·ªë th√¥ng b√°o ch∆∞a ƒë·ªçc c·ªßa user
    public function unreadCount()
    {
        $userEmail = Auth::user()->email;

        $unreadCount = Contact::where('email', $userEmail)
                              ->whereHas('replies') 
                              ->where('is_read', false)
                              ->count();

        return response()->json(['count' => $unreadCount]);
    }

    // Trang user xem c√°c tin nh·∫Øn & ƒë√°nh d·∫•u ƒë√£ ƒë·ªçc
    public function message()
    {
        $userEmail = Auth::user()->email;

        // ƒê√°nh d·∫•u c√°c ph·∫£n h·ªìi d√†nh cho user hi·ªán t·∫°i l√† ƒë√£ ƒë·ªçc
        Contact::where('email', $userEmail)
            ->whereHas('replies') // ch·ªâ ƒë√°nh d·∫•u nh·ªØng c√°i ƒë√£ ƒë∆∞·ª£c tr·∫£ l·ªùi
            ->where('is_read', false)
            ->update(['is_read' => true]);

        // L·∫•y t·∫•t c·∫£ li√™n h·ªá ƒë√£ g·ª≠i k√®m ph·∫£n h·ªìi
        $contacts = Contact::with('replies')
            ->where('email', $userEmail)
            ->latest()
            ->get();

        return view('user.contact-messages', compact('contacts'));
    }

    //  T·ªïng s·ªë t·∫•t c·∫£ c√°c li√™n h·ªá c√≥ ph·∫£n h·ªìi
    public function totalCount()
    {
        $userEmail = Auth::user()->email;

        $total = Contact::where('email', $userEmail)
                        ->whereHas('replies')
                        ->count();

        return response()->json(['total' => $total]);
    }
    public function counts()
{
    $userEmail = Auth::user()->email;

    $total = Contact::where('email', $userEmail)
                    ->whereHas('replies')
                    ->count();

    $unread = Contact::where('email', $userEmail)
                     ->whereHas('replies')
                     ->where('is_read', false)
                     ->count();

    return response()->json([
        'total' => $total,
        'unread' => $unread
    ]);
}

}

```
 



## Controller

#### Contact Controller

```php
public function send(Request $request)
    {
        $validated = $request->validate([
            'name'    => 'required|string|max:255',
            'email'   => 'required|email',
            'phone'   => 'required|string|max:20',
            'message' => 'required|string|max:1000',
        ]);

        // L∆∞u th√¥ng tin li√™n h·ªá v√†o database
        Contact::create([
            'name'    => $validated['name'],
            'email'   => $validated['email'],
            'phone'   => $validated['phone'],
            'message' => $validated['message'],
            'is_read' => false, // tin nh·∫Øn m·ªõi g·ª≠i s·∫Ω ch∆∞a ƒë·ªçc
        ]);

        return redirect()->back()->with('success', 'C·∫£m ∆°n b·∫°n ƒë√£ li√™n h·ªá!');
    }
```

#### AdminOrder Controller

```php
 public function index(Request $request)
    {
        $keyword = $request->input('keyword');

        $orders = Order::when($keyword, function ($query, $keyword) {
                $query->where('name', 'like', "%{$keyword}%");
            })
            ->with('orderDetails.product') 
            ->latest()
            ->paginate(10);

        return view('admin.order', compact('orders'));
    }

    public function update(Request $request, $id)
    {
        $request->validate([
            'name'          => 'required|string|max:50',
            'email'         => 'required|email|max:150',
            'phone'         => 'required|string|max:20',
            'address'       => 'required|string|max:200',
            'order_notes'   => 'nullable|string|max:1000',
            'total'         => 'required|numeric|min:0',
            'status'        => 'required|in:pending,processing,completed,cancelled',
        ]);

        $order = Order::findOrFail($id);

        $order->update([
            'name'          => $request->name,
            'email'         => $request->email,
            'phone'         => $request->phone,
            'address'       => $request->address,
            'order_notes'   => $request->order_notes,
            'total'         => $request->total,
            'status'        => $request->status,
        ]);

        return redirect()->route('admin.order')->with('success', 'Order updated successfully.');
    }

    public function destroy($id)
    {
        $order = Order::findOrFail($id);
        $order->delete();

        return redirect()->route('admin.order')->with('success', 'Order deleted successfully.');
    }
```

### AdminUserController

```php
 // Hi·ªÉn th·ªã danh s√°ch ng∆∞·ªùi d√πng v·ªõi t√¨m ki·∫øm
    public function index(Request $request)
    {
        $keyword = $request->keyword;

        $users = User::query()
            ->when($keyword, function ($query, $keyword) {
                return $query->where('email', 'like', '%' . $keyword . '%');
            })
            ->orderBy('id','asc')
            ->get();

        return view('admin.user', compact('users'));
    }

    // C·∫≠p nh·∫≠t th√¥ng tin ng∆∞·ªùi d√πng
    public function update(Request $request, $id)
    {
        $request->validate([
            'name'    => 'required|string|max:255',
            'email'   => 'required|email|max:255|unique:users,email,' . $id,
            'phone'   => 'nullable|string|max:20',
            'address' => 'nullable|string|max:255',
            'role'    => 'required|in:admin,user',
        ]);

        $user = User::findOrFail($id);

        $user->update([
            'name'    => $request->name,
            'email'   => $request->email,
            'phone'   => $request->phone,
            'address' => $request->address,
            'role'    => $request->role,
        ]);

        return redirect()->route('admin.user')->with('success', 'C·∫≠p nh·∫≠t ng∆∞·ªùi d√πng th√†nh c√¥ng!');
    }

    // X√≥a ng∆∞·ªùi d√πng
    public function destroy($id)
    {
        $user = User::findOrFail($id);
        $user->delete();

        return redirect()->route('admin.user')->with('success', 'X√≥a ng∆∞·ªùi d√πng th√†nh c√¥ng!');
    }
```


### üìÑ Blade Template (View)
![View](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/view.png)



---

<h1> üîí Security Setup</h1>

- S·ª≠ d·ª•ng CSRF Token cho m·ªçi form.
- Validate d·ªØ li·ªáu ƒë·∫ßu v√†o ·ªü Controller/Request.
- Ch·ªâ admin m·ªõi truy c·∫≠p ƒë∆∞·ª£c c√°c route qu·∫£n tr·ªã (middleware).
- S·ª≠ d·ª•ng Eloquent ORM ƒë·ªÉ ch·ªëng SQL Injection.
- Escape d·ªØ li·ªáu khi hi·ªÉn th·ªã ra view ƒë·ªÉ ch·ªëng XSS.

---

<h1> üîó Link </h1>

## Github link

[https://github.com/[PhanThiGiaHan108]/Organ](https://github.com/PhanThiGiaHan108/Organ)


---

<h1> üì∑ M·ªôt s·ªë h√¨nh ·∫£nh ch·ª©c nƒÉng ch√≠nh</h1>

-----User----


ƒêƒÉng k√Ω  

![ƒêƒÉng k√Ω](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/dang-ky.png)





ƒêƒÉng nh·∫≠p

![ƒêƒÉng nh·∫≠p](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/dang-nhap.png)

Trang ch·ªß

![Home](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/home.png)
![Home 2](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/home2.png)

 
Trang gi·ªõi thi·ªáu

![Gi·ªõi thi·ªáu](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/gioithieu.png)


Trang s·∫£n ph·∫©m

![Shop](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/shop.png)


Trang gi·ªè h√†ng

![Gi·ªè h√†ng](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/giohang.png)

Trang checkout

![Checkout](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/checkout.png)

Trang Contact

![Li√™n h·ªá](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/contact.png)

 Trang ph·∫£n h·ªìi
 
![Ph·∫£n h·ªìi](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/phan_hoi.png)

----Admin---


Dashboard
![image](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/home_admin.png)

Qu·∫£n l√Ω user

![image](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/qlu.png)

Qu·∫£n ƒë∆°n h√†ng
![image](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/qlo.png)

Qu·∫£n l√Ω s·∫£n ph·∫©m
![image](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/qlp.png)

Qu·∫£n l√Ω danh m·ª•c
![image](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/qlc.png)

Th√¥ng b√°o
![image](https://raw.githubusercontent.com/PhanThiGiaHan108/Organ/master/public/assets/images/thongbao.png)


---

<h1>License & Copy Rights</h1>

The Laravel framework is open-sourced software licensed under the <a href="https://opensource.org/licenses/MIT" rel="nofollow">MIT license.</a>
